<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cyberpunk Graph Visualizer</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
body{margin:0;display:flex;font-family:'Orbitron',sans-serif;background:#0d0d0d;color:#fff;height:100vh;}
#sidebar{width:300px;padding:15px;background:#111;border-right:2px solid #0ff;display:flex;flex-direction:column;}
h2{margin:0 0 10px 0;color:#f0f;font-weight:700;font-size:22px;}
label{margin-top:10px;font-size:14px;font-weight:600;}
button,select,input[type=range]{margin:8px 0;padding:8px;border:2px solid #0ff;border-radius:4px;width:100%;font-weight:700;background:#111;color:#0ff;cursor:pointer;transition:.2s;}
button:hover,select:hover,input[type=range]:hover{border-color:#0f0;color:#0f0;}
#explanation{flex:1;overflow-y:auto;background:#111;padding:8px;border-radius:6px;margin-top:12px;font-size:13px;border:1px solid #0ff;color:#0ff;}
#canvas{flex:1;background:#0d0d0d;cursor:crosshair;}
</style>
</head>
<body>
<div id="sidebar">
<h2>Cyberpunk Graph Visualizer</h2>
<label>Mode:</label>
<select id="mode"><option value="add">Add Node</option><option value="edge">Add Edge</option></select>
<label>Algorithm:</label>
<select id="algorithm"><option value="dijkstra">Dijkstra</option><option value="kruskal">Kruskal</option></select>
<div id="dijkstraOptions">
<label>Start:</label><select id="startNode"></select>
<label>End:</label><select id="endNode"></select>
</div>
<button onclick="setupRun()">Run</button>
<button onclick="stepOnce()">Step</button>
<button onclick="togglePlay()" id="playBtn">Play</button>
<label for="speed">Speed:</label>
<input type="range" id="speed" min="200" max="2000" step="100" value="800">
<button onclick="resetGraph()">Reset</button>
<div id="explanation"></div>
</div>
<canvas id="canvas"></canvas>
<script>
const canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");
canvas.width=window.innerWidth-300;canvas.height=window.innerHeight;
const NODE_RADIUS=20;let nodes={},edges={},nodeCount=0,selectedNode=null,generator=null,playing=false;

// DRAW
function drawGraph(h={}){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.lineWidth=2;ctx.font="14px Orbitron";
for(let u in edges)for(let {v,w} of edges[u]){
  const[x1,y1]=nodes[u],[x2,y2]=nodes[v];
  ctx.strokeStyle=(h.edge&&h.edge[`${u}-${v}`])||"#0ff";
  ctx.shadowColor="#0ff";ctx.shadowBlur=12;ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();ctx.shadowBlur=0;
  ctx.fillStyle="#f0f";ctx.fillText(w,(x1+x2)/2,(y1+y2)/2);}
for(let n in nodes){
  const[x,y]=nodes[n];
  ctx.fillStyle=(h.node&&h.node[n])||"#ff0";ctx.shadowColor="#ff0";ctx.shadowBlur=20;ctx.beginPath();ctx.arc(x,y,NODE_RADIUS,0,2*Math.PI);ctx.fill();ctx.shadowBlur=0;
  ctx.strokeStyle="#0ff";ctx.lineWidth=2;ctx.stroke();ctx.fillStyle="#0ff";ctx.fillText(n,x-5,y+5);
}}

// CLICK
canvas.addEventListener("click",e=>{
  const mode=document.getElementById("mode").value;
  const rect=canvas.getBoundingClientRect();const x=e.clientX-rect.left,y=e.clientY-rect.top;
  if(mode==="add"){const name=String.fromCharCode(65+nodeCount++);nodes[name]=[x,y];edges[name]=[];updateSelectors();}
  else if(mode==="edge"){const node=findNode(x,y);if(node){if(!selectedNode)selectedNode=node;else{const w=parseInt(prompt("Enter weight:"));if(!isNaN(w)){edges[selectedNode].push({v:node,w});edges[node].push({v:selectedNode,w});}selectedNode=null;}}}
  drawGraph();
});

function findNode(x,y){for(let n in nodes){const[nx,ny]=nodes[n];if(Math.hypot(nx-x,ny-y)<=NODE_RADIUS)return n;}return null;}
function updateSelectors(){const s=document.getElementById("startNode"),e=document.getElementById("endNode");s.innerHTML=e.innerHTML="";for(let n in nodes){s.add(new Option(n,n));e.add(new Option(n,n));}}
function log(msg){const exp=document.getElementById("explanation");exp.innerHTML+=msg+"<br>";exp.scrollTop=exp.scrollHeight;}

// DIJKSTRA
function* dijkstraSteps(start,end){let dist={},prev={},heap=[];for(let n in nodes)dist[n]=Infinity,prev[n]=null;dist[start]=0;heap.push([0,start]);log("Initialized distances.");
while(heap.length){heap.sort((a,b)=>a[0]-b[0]);let[d,u]=heap.shift();log(`POP: ${u} with dist ${d}`);if(u===end)break;for(let {v,w} of edges[u]){log(`Consider edge ${u}->${v} (w=${w})`);if(d+w<dist[v]){dist[v]=d;prev[v]=u;heap.push([dist[v],v]);log(`Relax ${v} to ${dist[v]}`);}}yield drawGraph({node:{[u]:"orange"}});}
log("Dijkstra finished.");let node=end;while(prev[node]){const p=prev[node];yield drawGraph({node:{[node]:"lime",[p]:"lime"},edge:{[`${p}-${node}`]:"lime",[`${node}-${p}`]:"lime"}});node=p;}}

// KRUSKAL
function* kruskalSteps(){let allEdges=[];for(let u in edges)for(let {v,w} of edges[u])if(u<v)allEdges.push({u,v,w});allEdges.sort((a,b)=>a.w-b.w);let parent={},rank={};for(let n in nodes)parent[n]=n,rank[n]=0;
function find(x){if(parent[x]!==x)parent[x]=find(parent[x]);return parent[x];}
function unite(x,y){x=find(x);y=find(y);if(x!==y){if(rank[x]<rank[y])[x,y]=[y,x];parent[y]=x;if(rank[x]===rank[y])rank[x]++;return true;}return false;}
for(let e of allEdges){log(`Considering edge ${e.u}-${e.v} (w=${e.w})`);if(unite(e.u,e.v)){log(`Accepted edge ${e.u}-${e.v}`);yield drawGraph({edge:{[`${e.u}-${e.v}`]:"lime",[`${e.v}-${e.u}`]:"lime"}});}else{log(`Rejected edge ${e.u}-${e.v}`);yield drawGraph({edge:{[`${e.u}-${e.v}`]:"#f00",[`${e.v}-${e.u}`]:"#f00"}});}}log("Kruskal finished.");}

// RUN
function setupRun(){const algo=document.getElementById("algorithm").value;if(algo==="dijkstra"){const s=document.getElementById("startNode").value,e=document.getElementById("endNode").value;if(!s||!e)return;generator=dijkstraSteps(s,e);}else generator=kruskalSteps();stepOnce();}
function stepOnce(){if(!generator)return;const res=generator.next();if(res.done){log("Done.");playing=false;}}
function togglePlay(){playing=!playing;document.getElementById("playBtn").innerText=playing?"Pause":"Play";if(playing)loop();}
function loop(){if(!playing)return;stepOnce();setTimeout(loop,parseInt(document.getElementById("speed").value));}
function resetGraph(){nodes={};edges={};nodeCount=0;selectedNode=null;generator=null;document.getElementById("startNode").innerHTML="";document.getElementById("endNode").innerHTML="";ctx.clearRect(0,0,canvas.width,canvas.height);document.getElementById("explanation").innerHTML="";}
drawGraph();
</script>
</body>
</html>



