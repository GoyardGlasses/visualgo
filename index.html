<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Graph Algorithm Visualizer</title>
  <style>
    /* ===== Minimal Brutalism Style ===== */
    body {
      display: flex;
      margin: 0;
      font-family: 'Inter', Arial, sans-serif;
      height: 100vh;
      background: #f5f5f5;
      color: #222;
    }

    #sidebar {
      width: 300px;
      background: #ffffff;
      color: #222;
      padding: 15px;
      display: flex;
      flex-direction: column;
      border-right: 4px solid #e0e0e0;
      box-shadow: 2px 0 8px rgba(0,0,0,0.05);
    }

    h2 {
      margin: 0 0 10px 0;
      font-weight: 700;
      font-size: 20px;
      letter-spacing: 0.5px;
      color: #111;
    }

    label {
      margin-top: 10px;
      font-size: 14px;
      font-weight: 600;
    }

    button, select, input[type=range] {
      margin: 8px 0;
      padding: 8px;
      border: 2px solid #ccc;
      border-radius: 6px;
      width: 100%;
      font-size: 14px;
      transition: all 0.2s ease;
      background: #fafafa;
      cursor: pointer;
    }

    button:hover, select:hover, input[type=range]:hover {
      border-color: #888;
      background: #f0f0f0;
    }

    button {
      font-weight: 700;
      color: #111;
      border: 2px solid #aaa;
    }

    #canvas {
      flex: 1;
      background: #ffffff;
      cursor: crosshair;
    }

    #explanation {
      flex: 1;
      overflow-y: auto;
      background: #f9f9f9;
      padding: 8px;
      border-radius: 6px;
      margin-top: 12px;
      font-size: 13px;
      border: 1px solid #ddd;
      color: #333;
    }

    /* Node & Edge Styling in Canvas */
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <div id="sidebar">
    <h2>Graph Algorithm Visualizer</h2>

    <label>Mode:</label>
    <select id="mode">
      <option value="move">Move</option>
      <option value="add">Add Node</option>
      <option value="edge">Add Edge</option>
    </select>

    <label>Algorithm:</label>
    <select id="algorithm">
      <option value="dijkstra">Dijkstra</option>
      <option value="kruskal">Kruskal</option>
    </select>

    <div id="dijkstraOptions">
      <label>Start:</label>
      <select id="startNode"></select>
      <label>End:</label>
      <select id="endNode"></select>
    </div>

    <label>Presets:</label>
    <select id="preset" onchange="loadPreset(this.value)">
      <option value="">-- Select Preset --</option>
      <option value="triangle">Triangle Graph</option>
      <option value="square">Square Graph</option>
      <option value="chain">Weighted Chain</option>
      <option value="random">Random Graph</option>
    </select>

    <button onclick="setupRun()">Setup</button>
    <button onclick="stepOnce()">Step</button>
    <button onclick="togglePlay()" id="playBtn">Play</button>

    <label for="speed">Speed:</label>
    <input type="range" id="speed" min="200" max="2000" step="100" value="800">

    <button onclick="resetGraph()">Reset</button>
    <div id="explanation"></div>
  </div>

  <canvas id="canvas"></canvas>

  <script>
    // ===== Canvas & Graph Logic (same as your original code) =====
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth - 300;
    canvas.height = window.innerHeight;

    const NODE_RADIUS = 20;
    let nodes = {};
    let edges = {};
    let nodeCount = 0;
    let selectedNode = null;

    let generator = null;
    let playing = false;

    function drawGraph(highlights = {}) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.lineWidth = 2;
      ctx.font = "14px Inter";

      // Draw edges
      for (let u in edges) {
        for (let { v, w } of edges[u]) {
          const [x1, y1] = nodes[u];
          const [x2, y2] = nodes[v];
          ctx.strokeStyle = (highlights.edge && highlights.edge[`${u}-${v}`]) || "#bbb";
          ctx.beginPath();
          ctx.moveTo(x1, y1);
          ctx.lineTo(x2, y2);
          ctx.stroke();
          ctx.fillStyle = "#555";
          ctx.fillText(w, (x1+x2)/2, (y1+y2)/2);
        }
      }

      // Draw nodes
      for (let n in nodes) {
        const [x, y] = nodes[n];
        ctx.fillStyle = (highlights.node && highlights.node[n]) || "#4fc3f7"; // soft cyan
        ctx.beginPath();
        ctx.arc(x, y, NODE_RADIUS, 0, 2*Math.PI);
        ctx.fill();
        ctx.strokeStyle = "#222";
        ctx.stroke();
        ctx.fillStyle = "#111";
        ctx.fillText(n, x-4, y+4);
      }
    }

    canvas.addEventListener("click", e => {
      const mode = document.getElementById("mode").value;
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      if (mode === "add") {
        const name = String.fromCharCode(65 + nodeCount++);
        nodes[name] = [x, y];
        edges[name] = [];
        updateSelectors();
      } else if (mode === "edge") {
        const node = findNode(x, y);
        if (node) {
          if (!selectedNode) {
            selectedNode = node;
          } else {
            const w = parseInt(prompt("Enter weight:"));
            if (!isNaN(w)) {
              edges[selectedNode].push({ v: node, w });
              edges[node].push({ v: selectedNode, w });
            }
            selectedNode = null;
          }
        }
      }
      drawGraph();
    });

    function findNode(x, y) {
      for (let n in nodes) {
        const [nx, ny] = nodes[n];
        if (Math.hypot(nx - x, ny - y) <= NODE_RADIUS) return n;
      }
      return null;
    }

    function updateSelectors() {
      const startSel = document.getElementById("startNode");
      const endSel = document.getElementById("endNode");
      startSel.innerHTML = endSel.innerHTML = "";
      for (let n in nodes) {
        startSel.add(new Option(n, n));
        endSel.add(new Option(n, n));
      }
    }

    // Dijkstra & Kruskal Generators (same as your original code)
    function* dijkstraSteps(start, end) { /*...original code...*/ }
    function* kruskalSteps() { /*...original code...*/ }

    function setupRun() { /*...original code...*/ }
    function stepOnce() { /*...original code...*/ }
    function togglePlay() { /*...original code...*/ }
    function loop() { /*...original code...*/ }
    function resetGraph() { /*...original code...*/ }
    function log(msg) { /*...original code...*/ }
    function loadPreset(type) { /*...original code...*/ }

    drawGraph();
  </script>
</body>
</html>
